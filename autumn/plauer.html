<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
     <meta property="og:image" content="ico.jpg">    
<title>Музыкальная Сборка</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Arial',sans-serif;background:linear-gradient(135deg,#0f0f23 0%,#1a1a2e 50%,#16213e 100%);color:#fff;min-height:100vh;overflow-x:hidden}
.container{max-width:1200px;margin:0 auto;padding:20px}
.album-section{text-align:center;margin-bottom:50px}
.album-cover{width:300px;height:300px;margin:0 auto;border-radius:20px;overflow:hidden;box-shadow:0 20px 60px rgba(0,0,0,0.5);background:linear-gradient(45deg,#00d4ff,#090979,#ff006e);animation:albumGlow 3s ease-in-out infinite alternate}
@keyframes albumGlow{0%{box-shadow:0 20px 60px rgba(0,212,255,0.3)}100%{box-shadow:0 30px 80px rgba(255,0,110,0.5)}}
.album-video{width:100%;height:100%;object-fit:cover}
.paused .playing-indicator .bar{animation-play-state:paused}
.album-info{margin-top:20px}
.album-title{font-size:2.5em;font-weight:bold;background:linear-gradient(45deg,#00d4ff,#ff006e);-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:10px}
.playlist{background:rgba(255,255,255,0.05);border-radius:20px;padding:30px;backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,0.1)}
.track{display:flex;align-items:center;padding:15px;margin-bottom:15px;background:rgba(255,255,255,0.03);border-radius:15px;cursor:pointer;transition:all .3s ease;position:relative;overflow:hidden}
.track:hover{background:rgba(255,255,255,0.08);transform:translateX(10px)}
.track.playing{background:linear-gradient(90deg,rgba(0,212,255,0.2),rgba(255,0,110,0.2));border:1px solid rgba(0,212,255,0.5)}
.track-number{width:40px;height:40px;background:rgba(255,255,255,0.1);border-radius:50%;display:flex;align-items:center;justify-content:center;margin-right:20px;font-weight:bold;transition:all .3s ease}
.track.playing .track-number{background:linear-gradient(45deg,#00d4ff,#ff006e);animation:pulse 1.5s ease-in-out infinite}
@keyframes pulse{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}
.track-info{flex:1}
.track-title{font-size:1.2em;margin-bottom:5px}
.track-artist{color:rgba(255,255,255,0.6);font-size:.9em}
.track-duration{color:rgba(255,255,255,0.6);font-size:.9em}
.playing-indicator{display:none;margin-left:20px}
.track.playing .playing-indicator{display:flex;align-items:flex-end;height:20px;gap:2px}
.bar{width:3px;background:linear-gradient(to top,#00d4ff,#ff006e);border-radius:3px;animation:soundWave .5s ease-in-out infinite}
.bar:nth-child(1){animation-delay:0s;height:10px}
.bar:nth-child(2){animation-delay:.1s;height:20px}
.bar:nth-child(3){animation-delay:.2s;height:15px}
.bar:nth-child(4){animation-delay:.3s;height:18px}
.bar:nth-child(5){animation-delay:.4s;height:12px}
@keyframes soundWave{0%,100%{transform:scaleY(0.5)}50%{transform:scaleY(1)}}
.controls{display:flex;justify-content:center;align-items:center;gap:20px;margin-top:30px}
.control-btn{width:50px;height:50px;border-radius:50%;background:rgba(255,255,255,0.1);border:2px solid rgba(255,255,255,0.2);color:#fff;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .3s ease;font-size:1.2em}
.control-btn:hover{background:rgba(255,255,255,0.2);transform:scale(1.1)}
.play-btn{width:60px;height:60px;background:linear-gradient(45deg,#00d4ff,#ff006e);border:none}
.progress-container{margin:20px 0}
.time-display{display:flex;justify-content:space-between;color:rgba(255,255,255,0.6);font-size:.85em;margin-bottom:5px}
.progress-bar{width:100%;height:6px;background:rgba(255,255,255,0.1);border-radius:3px;cursor:pointer;position:relative}
.progress{height:100%;background:linear-gradient(90deg,#00d4ff,#ff006e);border-radius:3px;width:0%;transition:width .1s ease;position:relative}
.progress::after{content:'';position:absolute;right:0;top:50%;transform:translateY(-50%);width:12px;height:12px;background:#fff;border-radius:50%;box-shadow:0 0 10px rgba(0,212,255,0.5)}
.volume-control{display:flex;align-items:center;gap:10px;margin-top:20px;justify-content:center}
.volume-icon{font-size:1.2em;color:rgba(255,255,255,0.7)}
.volume-slider{width:150px;height:6px;background:rgba(255,255,255,0.1);border-radius:3px;cursor:pointer;position:relative;-webkit-appearance:none;appearance:none}
.volume-slider::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:14px;height:14px;background:#fff;border-radius:50%;cursor:pointer;box-shadow:0 0 10px rgba(0,212,255,0.5)}
.volume-slider::-moz-range-thumb{width:14px;height:14px;background:#fff;border-radius:50%;cursor:pointer;border:none;box-shadow:0 0 10px rgba(0,212,255,0.5)}
.mode-controls{display:flex;gap:10px;margin-top:15px;justify-content:center}
.mode-btn{padding:8px 16px;border-radius:20px;background:rgba(255,255,255,0.1);border:1px solid rgba(255,255,255,0.2);color:rgba(255,255,255,0.6);cursor:pointer;transition:all .3s ease;font-size:.9em}
.mode-btn:hover{background:rgba(255,255,255,0.2);color:#fff}
.mode-btn.active{background:linear-gradient(45deg,#00d4ff,#ff006e);color:#fff;border-color:transparent}
@media (max-width:768px){
.container{padding:10px}
.album-cover{width:200px;height:200px}
.album-title{font-size:1.8em}
.playlist{padding:15px}
.track{padding:10px;margin-bottom:10px}
.track-number{width:35px;height:35px;margin-right:15px;font-size:0.9em}
.track-title{font-size:1em}
.track-artist,.track-duration{font-size:0.8em}
.control-btn{width:45px;height:45px;font-size:1em}
.play-btn{width:55px;height:55px}
.volume-control{margin-top:15px}
.volume-slider{width:120px}
.mode-controls{flex-wrap:wrap}
.mode-btn{padding:6px 12px;font-size:0.85em}
}
@media (max-width:480px){
.album-cover{width:150px;height:150px}
.album-title{font-size:1.5em}
.track{flex-wrap:wrap}
.track-info{min-width:calc(100% - 60px)}
.track-duration{margin-left:55px;margin-top:5px}
.playing-indicator{margin-left:0;margin-top:5px}
.controls{gap:15px}
.control-btn{width:40px;height:40px}
.play-btn{width:50px;height:50px}
}
</style>
</head>
<body>
<div class="container">
    <div class="album-section">
        <div class="album-cover">
            <video class="album-video" id="albumVideo" src="video.mp4" muted loop playsinline></video>
        </div>
        <div class="album-info">
            <h1 class="album-title">Моя Музыкальная Сборка</h1>
            <p>Создано специально для вас</p>
        </div>
    </div>

    <div class="playlist" id="playlist"></div>

    <div class="progress-container">
        <div class="time-display">
            <span id="currentTime">0:00</span>
            <span id="totalTime">0:00</span>
        </div>
        <div class="progress-bar" onclick="seekTo(event)">
            <div class="progress"></div>
        </div>
    </div>

    <div class="controls">
        <button class="control-btn" onclick="previousTrack()">⮜</button>
        <button class="control-btn play-btn" onclick="togglePlay()">▶</button>
        <button class="control-btn" onclick="nextTrack()">⮞</button>
    </div>

    <div class="volume-control">
        <span class="volume-icon" id="volumeIcon">🔊</span>
        <input type="range" class="volume-slider" id="volumeSlider" min="0" max="100" value="100">
    </div>

    <div class="mode-controls">
        <button class="mode-btn" id="repeatBtn" onclick="toggleRepeat()">🔁 Повтор: Выкл</button>
        <button class="mode-btn" id="shuffleBtn" onclick="toggleShuffle()">🔀 Shuffle</button>
    </div>
</div>

<audio id="audio"></audio>

<script>
const tracks=[
  {title:"Уже не лето но ещё не осень.mp3",artist:"Артист 1",src:"Уже_не_лето_но_ещё_не_осень.mp3",duration:"2:18"},
  {title:"Смотри как осень краски щедро льёт",artist:"Артист 2",src:"Смотри_как_осень_краски_щедро_льёт.mp3",duration:"3:45"},
  {title:"Вот опять наступила осень.mp3",artist:"Артист 3",src:"Вот_опять_наступила_осень.mp3",duration:"4:12"},
  {title:"Жёлтые листья медленно кружат.mp3",artist:"Артист 4",src:"Жёлтые_листья_медленно_кружат.mp3",duration:"5:30"},
  {title:"Одна листва.mp3",artist:"Артист 5",src:"Одна_листва.mp3",duration:"3:45"},
  {title:"Осень в платье пышном.mp3",artist:"Артист 6",src:"Осень_в_платье_пышном.mp3",duration:"4:12"},
  {title:"Снова жёлтой листвой покрылась земля.mp3",artist:"Артист 7",src:"Снова_жёлтой_листвой_покрылась_земля.mp3",duration:"2:30"},
  {title:"Снова осень пришла.mp3",artist:"Артист 8",src:"Снова_осень_пришла.mp3",duration:"3:25"},
  {title:"Вот опять наступила осень(2).mp3",artist:"Артист 9",src:"Вот_опять_наступила_осень(2).mp3",duration:"3:40"},
  {title:"Снова жёлтой листвой покрылась_земля(2).mp3",artist:"Артист 10",src:"Снова_жёлтой_листвой_покрылась_земля(2).mp3",duration:"3:25"},
  {title:"Уже не лето но ещё не осень(2).mp3",artist:"Артист 11",src:"Уже_не_лето_но_ещё_не_осень(2).mp3",duration:"2:18"}
];

const playlist=document.getElementById('playlist');
tracks.forEach((t,i)=>{
  playlist.innerHTML+=`
    <div class="track" onclick="playTrack(${i})">
      <div class="track-number">${i+1}</div>
      <div class="track-info">
        <div class="track-title">${t.title}</div>
        <div class="track-artist">${t.artist}</div>
      </div>
      <div class="track-duration">${t.duration}</div>
      <div class="playing-indicator">
        <div class="bar"></div>
        <div class="bar"></div>
        <div class="bar"></div>
        <div class="bar"></div>
        <div class="bar"></div>
      </div>
    </div>`;
});

const audio=document.getElementById('audio');
const albumVideo=document.getElementById('albumVideo');
const volumeSlider=document.getElementById('volumeSlider');
const volumeIcon=document.getElementById('volumeIcon');
let currentTrack=null;
let isPlaying=false;
let repeatMode=0;
let shuffleMode=false;
let playHistory=[];

function playTrack(i){
  document.querySelectorAll('.track').forEach(el=>el.classList.remove('playing'));
  currentTrack=i;
  playHistory.push(i);
  if(playHistory.length>10)playHistory.shift();
  const track=tracks[i];
  audio.src=track.src;
  audio.play();
  albumVideo.play();
  isPlaying=true;
  updatePlayButton();
  document.querySelectorAll('.track')[i].classList.add('playing');
  document.querySelectorAll('.track')[i].classList.remove('paused');
  saveState();
}

function togglePlay(){
  if(currentTrack===null){playTrack(0);return;}
  if(isPlaying){
    audio.pause();
    albumVideo.pause();
    isPlaying=false;
    document.querySelectorAll('.track')[currentTrack].classList.add('paused');
  }
  else{
    audio.play();
    albumVideo.play();
    isPlaying=true;
    document.querySelectorAll('.track')[currentTrack].classList.remove('paused');
  }
  updatePlayButton();
}

function updatePlayButton(){
  document.querySelector('.play-btn').textContent=isPlaying?'⏸':'▶';
}

function formatTime(seconds){
  if(isNaN(seconds))return '0:00';
  const m=Math.floor(seconds/60);
  const s=Math.floor(seconds%60);
  return m+':'+(s<10?'0':'')+s;
}

function nextTrack(){
  if(currentTrack===null)return;
  let n;
  if(shuffleMode){
    do{n=Math.floor(Math.random()*tracks.length);}
    while(n===currentTrack&&tracks.length>1);
  }else{
    n=currentTrack+1;
    if(n>=tracks.length){
      if(repeatMode===2){
        n=0;
      }else{
        isPlaying=false;
        updatePlayButton();
        return;
      }
    }
  }
  playTrack(n);
}

function previousTrack(){
  if(currentTrack===null)return;
  if(shuffleMode&&playHistory.length>1){
    playHistory.pop();
    const prev=playHistory[playHistory.length-1];
    playHistory.pop();
    playTrack(prev);
  }else{
    let p=currentTrack-1;
    if(p<0)p=tracks.length-1;
    playTrack(p);
  }
}

function seekTo(e){
  if(audio.duration){
    const bar=e.currentTarget;
    const x=e.offsetX;
    const w=bar.offsetWidth;
    audio.currentTime=(x/w)*audio.duration;
  }
}

function updateVolumeIcon(v){
  if(v==0)volumeIcon.textContent='🔇';
  else if(v<33)volumeIcon.textContent='🔈';
  else if(v<66)volumeIcon.textContent='🔉';
  else volumeIcon.textContent='🔊';
}

function toggleRepeat(){
  repeatMode=(repeatMode+1)%3;
  const btn=document.getElementById('repeatBtn');
  const modes=['Выкл','Трек','Все'];
  btn.textContent='🔁 Повтор: '+modes[repeatMode];
  btn.classList.toggle('active',repeatMode>0);
  audio.loop=repeatMode===1;
  saveState();
}

function toggleShuffle(){
  shuffleMode=!shuffleMode;
  const btn=document.getElementById('shuffleBtn');
  btn.classList.toggle('active',shuffleMode);
  saveState();
}

function saveState(){
  const state={
    currentTrack:currentTrack,
    currentTime:audio.currentTime,
    volume:audio.volume,
    repeatMode:repeatMode,
    shuffleMode:shuffleMode,
    isPlaying:isPlaying
  };
  try{
    const stateStr=JSON.stringify(state);
    const compressed=btoa(stateStr);
    history.replaceState(null,'',location.pathname+'#'+compressed);
  }catch(e){console.log('Save state error:',e)}
}

function loadState(){
  try{
    const hash=location.hash.substring(1);
    if(!hash)return false;
    const stateStr=atob(hash);
    const state=JSON.parse(stateStr);
    
    if(state.currentTrack!==null&&state.currentTrack<tracks.length){
      currentTrack=state.currentTrack;
      audio.src=tracks[currentTrack].src;
      audio.currentTime=state.currentTime||0;
      audio.volume=state.volume||1;
      volumeSlider.value=audio.volume*100;
      updateVolumeIcon(volumeSlider.value);
      
      repeatMode=state.repeatMode||0;
      shuffleMode=state.shuffleMode||false;
      
      const repeatBtn=document.getElementById('repeatBtn');
      const modes=['Выкл','Трек','Все'];
      repeatBtn.textContent='🔁 Повтор: '+modes[repeatMode];
      if(repeatMode>0)repeatBtn.classList.add('active');
      audio.loop=repeatMode===1;
      
      const shuffleBtn=document.getElementById('shuffleBtn');
      if(shuffleMode)shuffleBtn.classList.add('active');
      
      document.querySelectorAll('.track')[currentTrack].classList.add('playing');
      
      if(state.isPlaying){
        audio.play().catch(()=>{
          isPlaying=false;
          updatePlayButton();
        });
        albumVideo.play().catch(()=>{});
        isPlaying=true;
      }else{
        isPlaying=false;
      }
      updatePlayButton();
      return true;
    }
  }catch(e){console.log('Load state error:',e)}
  return false;
}

volumeSlider.addEventListener('input',function(){
  audio.volume=this.value/100;
  updateVolumeIcon(this.value);
  saveState();
});

audio.addEventListener('ended',function(){
  if(repeatMode===1)return;
  if(repeatMode===2||repeatMode===0){
    nextTrack();
  }
});

audio.addEventListener('timeupdate',function(){
  const p=(audio.currentTime/audio.duration)*100;
  document.querySelector('.progress').style.width=p+'%';
  document.getElementById('currentTime').textContent=formatTime(audio.currentTime);
  if(Math.floor(audio.currentTime)%5===0){
    saveState();
  }
});

audio.addEventListener('loadedmetadata',function(){
  document.getElementById('totalTime').textContent=formatTime(audio.duration);
});

window.addEventListener('load',function(){
  loadState();
});
</script>
</body>
</html>
